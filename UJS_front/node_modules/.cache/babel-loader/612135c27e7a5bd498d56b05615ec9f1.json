{"remainingRequest":"C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\src\\assets\\FlappyBird\\bird.js","dependencies":[{"path":"C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\src\\assets\\FlappyBird\\bird.js","mtime":1558272195765},{"path":"C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["function Bird(x, y, image) {\n  this.x = x, this.y = y, this.width = image.width / 2, this.height = image.height, this.image = image;\n\n  this.draw = function (context, state) {\n    if (state === \"up\") context.drawImage(image, 0, 0, this.width, this.height, this.x, this.y, this.width, this.height);else {\n      context.drawImage(image, this.width, 0, this.width, this.height, this.x, this.y, this.width, this.height);\n    }\n  };\n}\n\nfunction Obstacle(x, y, h, image) {\n  this.x = x, this.y = y, this.width = image.width / 2, this.height = h, this.draw = function (context, state) {\n    if (state === \"up\") {\n      context.drawImage(image, 0, 0, this.width, this.height, this.x, this.y, this.width, this.height);\n    } else {\n      context.drawImage(image, this.width, image.height - this.height, this.width, this.height, this.x, this.y, this.width, this.height);\n    }\n  };\n}\n\nfunction FlappyBird() {}\n\nFlappyBird.prototype = {\n  bird: null,\n  // 小鸟\n  bg: null,\n  // 背景图\n  obs: null,\n  // 障碍物\n  obsList: [],\n  mapWidth: 340,\n  // 画布宽度\n  mapHeight: 453,\n  // 画布高度\n  startX: 90,\n  // 起始位置\n  startY: 225,\n  obsDistance: 100,\n  // 上下障碍物距离\n  obsSpeed: 2,\n  // 障碍物移动速度\n  obsInterval: 2000,\n  // 制造障碍物间隔ms\n  upSpeed: 8,\n  // 上升速度\n  downSpeed: 3,\n  // 下降速度\n  line: 56,\n  // 地面高度\n  score: 0,\n  // 得分\n  touch: false,\n  // 是否触摸\n  gameOver: false,\n  CreateMap: function CreateMap() {\n    //背景\n    this.bg = new Image();\n    this.bg.src = \"img/bg.png\";\n    var startBg = new Image();\n    startBg.src = \"img/start.jpg\"; // 由于Image异步加载, 在加载完成时在绘制图像\n\n    startBg.onload = function () {\n      c.drawImage(startBg, 0, 0);\n    }; //小鸟\n\n\n    var image = new Image();\n    image.src = \"img/bird.png\";\n\n    image.onload = function () {\n      this.bird = new Bird(this.startX, this.startY, image); //this.bird.draw(c, \"down\");\n    }.bind(this); //障碍物\n\n\n    this.obs = new Image();\n    this.obs.src = \"img/obs.png\";\n\n    this.obs.onload = function () {\n      var h = 100; // 默认第一障碍物上管道高度为100\n\n      var h2 = this.mapHeight - h - this.obsDistance;\n      var obs1 = new Obstacle(this.mapWidth, 0, h, this.obs);\n      var obs2 = new Obstacle(this.mapWidth, this.mapHeight - h2, h2 - this.line, this.obs);\n      this.obsList.push(obs1);\n      this.obsList.push(obs2);\n    }.bind(this);\n  },\n  CreateObs: function CreateObs() {\n    // 随机产生障碍物上管道高度\n    var h = Math.floor(Math.random() * (this.mapHeight - this.obsDistance - this.line));\n    var h2 = this.mapHeight - h - this.obsDistance;\n    var obs1 = new Obstacle(this.mapWidth, 0, h, this.obs);\n    var obs2 = new Obstacle(this.mapWidth, this.mapHeight - h2, h2 - this.line, this.obs);\n    this.obsList.push(obs1);\n    this.obsList.push(obs2); // 移除越界障碍物\n\n    if (this.obsList[0].x < -this.obsList[0].width) this.obsList.splice(0, 2);\n  },\n  DrawObs: function DrawObs() {\n    //绘制障碍物\n    c.fillStyle = \"#00ff00\";\n\n    for (var i = 0; i < this.obsList.length; i++) {\n      this.obsList[i].x -= this.obsSpeed;\n      if (i % 2) this.obsList[i].draw(c, \"up\");else this.obsList[i].draw(c, \"down\");\n    }\n  },\n  CountScore: function CountScore() {\n    // 计分\n    if (this.score == 0 && this.obsList[0].x + this.obsList[0].width < this.startX) {\n      this.score = 1;\n      return true;\n    }\n\n    return false;\n  },\n  CanMove: function CanMove() {\n    // 碰撞检测\n    if (this.bird.y < 0 || this.bird.y > this.mapHeight - this.bird.height - this.line) {\n      this.gameOver = true;\n    } else {\n      var boundary = [{\n        x: this.bird.x,\n        y: this.bird.y\n      }, {\n        x: this.bird.x + this.bird.width,\n        y: this.bird.y\n      }, {\n        x: this.bird.x,\n        y: this.bird.y + this.bird.height\n      }, {\n        x: this.bird.x + this.bird.width,\n        y: this.bird.y + this.bird.height\n      }];\n\n      for (var i = 0; i < this.obsList.length; i++) {\n        for (var j = 0; j < 4; j++) {\n          if (boundary[j].x >= this.obsList[i].x && boundary[j].x <= this.obsList[i].x + this.obsList[i].width && boundary[j].y >= this.obsList[i].y && boundary[j].y <= this.obsList[i].y + this.obsList[i].height) {\n            this.gameOver = true;\n            break;\n          }\n        }\n\n        if (this.gameOver) break;\n      }\n    }\n  },\n  CheckTouch: function CheckTouch() {\n    // 检测触摸\n    if (this.touch) {\n      this.bird.y -= this.upSpeed;\n      this.bird.draw(c, \"up\");\n    } else {\n      this.bird.y += this.downSpeed;\n      this.bird.draw(c, \"down\");\n    }\n  },\n  ClearScreen: function ClearScreen() {\n    // 清屏\n    c.drawImage(this.bg, 0, 0);\n  },\n  ShowOver: function ShowOver() {\n    var refreshImg = new Image();\n    refreshImg.src = \"img/refresh1.png\";\n    var rx = (this.mapWidth - refreshImg.width) / 2 + 10;\n    var ry = (this.mapHeight - refreshImg.height) / 2 + 10;\n    var overImg = new Image();\n    overImg.src = \"img/gameover1.png\"; //window.location.reload();\n\n    overImg.onload = function () {\n      c.drawImage(overImg, (this.mapWidth - overImg.width) / 2, (this.mapHeight - overImg.height) / 2 - 50);\n      c.drawImage(refreshImg, rx - 30, ry);\n      c.strokeStyle = \"#000\";\n      c.lineWidth = 1;\n      c.fillStyle = \"#fff\";\n      c.fillText(this.score, rx - 25, ry - 20);\n      c.strokeText(this.score, rx - 25, ry - 20);\n      canvas.addEventListener('click', function (e) {\n        p = getEventPosition(e);\n\n        if (isClickinRefresh(rx, ry, refreshImg.width, refreshImg.height, p.x, p.y)) {\n          window.location.reload();\n        }\n      }, false);\n    }.bind(this);\n\n    return;\n  }\n};\n\nfunction isClickinRefresh(x0, y0, width, height, x, y) {\n  return x >= x0 && x <= x0 + width && y >= y0 && y <= y0 + height;\n}\n\nfunction getEventPosition(ev) {\n  var x, y;\n\n  if (ev.layerX || ev.layerX == 0) {\n    x = ev.layerX;\n    y = ev.layerY;\n  } else if (ev.offsetX || ev.offsetX == 0) {\n    // Opera\n    x = ev.offsetX;\n    y = ev.offsetY;\n  }\n\n  return {\n    x: x,\n    y: y\n  };\n}\n\nvar game = new FlappyBird();\nvar Speed = 20;\nvar IsPlay = false;\nwindow.onload = InitGame;\n\nfunction InitGame() {\n  c.font = \"3em 微软雅黑\";\n  game.CreateMap();\n\n  canvas.onmousedown = function () {\n    game.touch = true;\n  };\n\n  canvas.onmouseup = function () {\n    game.touch = false;\n  };\n\n  canvas.onclick = function () {\n    if (!IsPlay) {\n      IsPlay = true;\n    }\n  };\n}\n\nfunction RunGame(speed) {\n  var updateTimer = setInterval(function () {\n    // 若小鸟通过第一个障碍物启动记分器\n    if (game.CountScore()) {\n      var scoreTimer = setInterval(function () {\n        if (game.gameOver) {\n          clearInterval(scoreTimer);\n          return;\n        }\n\n        game.score++;\n      }, game.obsInterval);\n    }\n\n    game.CanMove();\n\n    if (game.gameOver) {\n      game.ShowOver();\n      clearInterval(updateTimer);\n      return;\n    }\n\n    game.ClearScreen();\n    game.DrawObs();\n    game.CheckTouch();\n  }, speed);\n  var obsTimer = setInterval(function () {\n    if (game.gameOver) {\n      clearInterval(obsTimer);\n      return;\n    }\n\n    game.CreateObs();\n  }, game.obsInterval);\n}",{"version":3,"sources":["C:\\Users\\15985\\IdeaProjects\\Vue\\src\\vuepro\\src\\assets\\FlappyBird\\bird.js"],"names":["Bird","x","y","image","width","height","draw","context","state","drawImage","Obstacle","h","FlappyBird","prototype","bird","bg","obs","obsList","mapWidth","mapHeight","startX","startY","obsDistance","obsSpeed","obsInterval","upSpeed","downSpeed","line","score","touch","gameOver","CreateMap","Image","src","startBg","onload","c","bind","h2","obs1","obs2","push","CreateObs","Math","floor","random","splice","DrawObs","fillStyle","i","length","CountScore","CanMove","boundary","j","CheckTouch","ClearScreen","ShowOver","refreshImg","rx","ry","overImg","strokeStyle","lineWidth","fillText","strokeText","canvas","addEventListener","e","p","getEventPosition","isClickinRefresh","window","location","reload","x0","y0","ev","layerX","layerY","offsetX","offsetY","game","Speed","IsPlay","InitGame","font","onmousedown","onmouseup","onclick","RunGame","speed","updateTimer","setInterval","scoreTimer","clearInterval","obsTimer"],"mappings":"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","sourcesContent":["\r\nfunction Bird(x, y, image) {\r\n    this.x = x,\r\n        this.y = y,\r\n        this.width = image.width / 2,\r\n        this.height = image.height,\r\n        this.image = image;\r\n    this.draw = function (context, state) {\r\n        if (state === \"up\")\r\n            context.drawImage(image, 0, 0, this.width, this.height, this.x, this.y, this.width, this.height);\r\n        else {\r\n            context.drawImage(image, this.width, 0, this.width, this.height, this.x, this.y, this.width, this.height);\r\n        }\r\n    }\r\n}\r\n\r\nfunction Obstacle(x, y, h, image) {\r\n    this.x = x,\r\n        this.y = y,\r\n        this.width = image.width / 2,\r\n        this.height = h,\r\n        this.draw = function (context, state) {\r\n            if (state === \"up\") {\r\n                context.drawImage(image, 0, 0, this.width, this.height, this.x, this.y, this.width, this.height);\r\n            } else {\r\n                context.drawImage(image, this.width, image.height - this.height, this.width, this.height, this.x, this.y, this.width, this.height);\r\n            }\r\n        }\r\n}\r\n\r\nfunction FlappyBird() {\r\n}\r\n\r\nFlappyBird.prototype = {\r\n    bird: null, // 小鸟\r\n    bg: null, // 背景图\r\n    obs: null, // 障碍物\r\n    obsList: [],\r\n\r\n    mapWidth: 340, // 画布宽度\r\n    mapHeight: 453, // 画布高度\r\n    startX: 90, // 起始位置\r\n    startY: 225,\r\n    obsDistance: 100, // 上下障碍物距离\r\n    obsSpeed: 2, // 障碍物移动速度\r\n    obsInterval: 2000, // 制造障碍物间隔ms\r\n    upSpeed: 8, // 上升速度\r\n    downSpeed: 3, // 下降速度\r\n    line: 56, // 地面高度\r\n    score: 0, // 得分\r\n    touch: false, // 是否触摸\r\n    gameOver: false,\r\n    CreateMap: function () {\r\n        //背景\r\n        this.bg = new Image();\r\n        this.bg.src = \"img/bg.png\";\r\n        var startBg = new Image();\r\n        startBg.src = \"img/start.jpg\";\r\n        // 由于Image异步加载, 在加载完成时在绘制图像\r\n        startBg.onload = function () {\r\n            c.drawImage(startBg, 0, 0);\r\n        };\r\n\r\n        //小鸟\r\n        var image = new Image();\r\n        image.src = \"img/bird.png\";\r\n        image.onload = function () {\r\n            this.bird = new Bird(this.startX, this.startY, image);\r\n            //this.bird.draw(c, \"down\");\r\n        }.bind(this);\r\n\r\n        //障碍物\r\n        this.obs = new Image();\r\n        this.obs.src = \"img/obs.png\";\r\n        this.obs.onload = function () {\r\n            var h = 100; // 默认第一障碍物上管道高度为100\r\n            var h2 = this.mapHeight - h - this.obsDistance;\r\n            var obs1 = new Obstacle(this.mapWidth, 0, h, this.obs);\r\n            var obs2 = new Obstacle(this.mapWidth, this.mapHeight - h2, h2 - this.line, this.obs);\r\n            this.obsList.push(obs1);\r\n            this.obsList.push(obs2);\r\n        }.bind(this);\r\n    },\r\n    CreateObs: function () {\r\n        // 随机产生障碍物上管道高度\r\n        var h = Math.floor(Math.random() * (this.mapHeight - this.obsDistance - this.line));\r\n        var h2 = this.mapHeight - h - this.obsDistance;\r\n        var obs1 = new Obstacle(this.mapWidth, 0, h, this.obs);\r\n        var obs2 = new Obstacle(this.mapWidth, this.mapHeight - h2, h2 - this.line, this.obs);\r\n        this.obsList.push(obs1);\r\n        this.obsList.push(obs2);\r\n\r\n        // 移除越界障碍物\r\n        if (this.obsList[0].x < -this.obsList[0].width)\r\n            this.obsList.splice(0, 2);\r\n    },\r\n    DrawObs: function () { //绘制障碍物\r\n        c.fillStyle = \"#00ff00\";\r\n        for (var i = 0; i < this.obsList.length; i++) {\r\n            this.obsList[i].x -= this.obsSpeed;\r\n            if (i % 2)\r\n                this.obsList[i].draw(c, \"up\");\r\n            else\r\n                this.obsList[i].draw(c, \"down\");\r\n        }\r\n    },\r\n    CountScore: function () { // 计分\r\n        if (this.score == 0 && this.obsList[0].x + this.obsList[0].width < this.startX) {\r\n            this.score = 1;\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n    CanMove: function () { // 碰撞检测\r\n        if (this.bird.y < 0 || this.bird.y > this.mapHeight - this.bird.height - this.line) {\r\n            this.gameOver = true;\r\n        } else {\r\n            var boundary = [{\r\n                x: this.bird.x,\r\n                y: this.bird.y\r\n            }, {\r\n                x: this.bird.x + this.bird.width,\r\n                y: this.bird.y\r\n            }, {\r\n                x: this.bird.x,\r\n                y: this.bird.y + this.bird.height\r\n            }, {\r\n                x: this.bird.x + this.bird.width,\r\n                y: this.bird.y + this.bird.height\r\n            }];\r\n            for (var i = 0; i < this.obsList.length; i++) {\r\n                for (var j = 0; j < 4; j++)\r\n                    if (boundary[j].x >= this.obsList[i].x && boundary[j].x <= this.obsList[i].x + this.obsList[i].width && boundary[j].y >= this.obsList[i].y && boundary[j].y <= this.obsList[i].y + this.obsList[i].height) {\r\n                        this.gameOver = true;\r\n                        break;\r\n                    }\r\n                if (this.gameOver)\r\n                    break;\r\n            }\r\n        }\r\n    },\r\n    CheckTouch: function () { // 检测触摸\r\n        if (this.touch) {\r\n            this.bird.y -= this.upSpeed;\r\n            this.bird.draw(c, \"up\");\r\n        } else {\r\n            this.bird.y += this.downSpeed;\r\n            this.bird.draw(c, \"down\");\r\n        }\r\n    },\r\n    ClearScreen: function () { // 清屏\r\n        c.drawImage(this.bg, 0, 0);\r\n    },\r\n    ShowOver: function () {\r\n\t\tvar refreshImg = new Image();\r\n\t\trefreshImg.src = \"img/refresh1.png\";\r\n\t\tvar rx = (this.mapWidth - refreshImg.width) / 2 + 10;\r\n\t\tvar ry = (this.mapHeight - refreshImg.height) / 2 + 10;\r\n        var overImg = new Image();\r\n        overImg.src = \"img/gameover1.png\";\r\n        //window.location.reload();\r\n        overImg.onload = function () {\r\n            c.drawImage(overImg, (this.mapWidth - overImg.width) / 2, (this.mapHeight - overImg.height) / 2 - 50);\r\n\t\t\tc.drawImage(refreshImg, rx - 30, ry);\r\n\t\t\tc.strokeStyle = \"#000\";\r\n\t\t\tc.lineWidth = 1;\r\n\t\t\tc.fillStyle = \"#fff\"\r\n\t\t\tc.fillText(this.score, rx-25, ry-20);\r\n\t\t\tc.strokeText(this.score, rx-25, ry-20);\r\n\t\t\t\r\n\t\t\tcanvas.addEventListener('click', function(e){\r\n\t\t\t\tp = getEventPosition(e);\r\n\t\t\t\tif(isClickinRefresh(rx, ry, refreshImg.width, refreshImg.height, p.x, p.y))\r\n\t\t\t\t{\r\n\t\t\t\t\twindow.location.reload();\r\n\t\t\t\t}\r\n\t\t\t}, false);\r\n        }.bind(this);\r\n        return;\r\n    }\r\n};\r\nfunction isClickinRefresh (x0, y0, width, height, x, y) {\r\n    return x >= x0 && x <= (x0 + width) && y >= y0 && y <= (y0 + height);\r\n}\r\nfunction getEventPosition(ev){\r\n  var x, y;\r\n  if (ev.layerX || ev.layerX == 0) {\r\n    x = ev.layerX;\r\n    y = ev.layerY;\r\n  } else if (ev.offsetX || ev.offsetX == 0) { // Opera\r\n    x = ev.offsetX;\r\n    y = ev.offsetY;\r\n  }\r\n  return {x: x, y: y};\r\n}\r\n\r\n\r\n\r\nvar game = new FlappyBird();\r\nvar Speed = 20;\r\nvar IsPlay = false;\r\nwindow.onload = InitGame;\r\n\r\nfunction InitGame() {\r\n    c.font = \"3em 微软雅黑\";\r\n    game.CreateMap();\r\n\r\n    canvas.onmousedown = function () {\r\n        game.touch = true;\r\n    }\r\n    canvas.onmouseup = function () {\r\n        game.touch = false;\r\n    };\r\n    canvas.onclick = function () {\r\n        if (!IsPlay) {\r\n            IsPlay = true;\r\n        }\r\n    }\r\n}\r\n\r\nfunction RunGame(speed) {\r\n    var updateTimer = setInterval(function () {\r\n        // 若小鸟通过第一个障碍物启动记分器\r\n        if (game.CountScore()) {\r\n            var scoreTimer = setInterval(function () {\r\n                if (game.gameOver) {\r\n                    clearInterval(scoreTimer);\r\n                    return;\r\n                }\r\n                game.score++;\r\n            }, game.obsInterval);\r\n        }\r\n\r\n        game.CanMove();\r\n        if (game.gameOver) {\r\n            game.ShowOver();\r\n            clearInterval(updateTimer);\r\n            return;\r\n        }\r\n        game.ClearScreen();\r\n        game.DrawObs();\r\n        game.CheckTouch();\r\n    }, speed);\r\n    var obsTimer = setInterval(function () {\r\n        if (game.gameOver) {\r\n            clearInterval(obsTimer);\r\n            return;\r\n        }\r\n        game.CreateObs();\r\n    }, game.obsInterval);\r\n}"]}]}